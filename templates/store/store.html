{% extends 'base.html' %}
{% load static %}
{% block content %}

<section class="ps-section">

  <!-- ITEMS FOUND -->
  <div class="container mb-4">
    <div class="row justify-content-center">
      <div class="col-12 col-md-10">
        <p></p>
        <div class="ps-item-count-box ps-items-found">
          <b>{{ product_count }}</b> items found
        </div>
      </div>
    </div>
  </div>

  <div class="container">
    <div class="row">

      <!-- SIDEBAR FILTERS -->
      <aside class="col-md-3 mb-4">
        <div class="ps-sidebar">

          <!-- CATEGORIES -->
          <div class="ps-item-count-box ps-sidebar-header">Categories</div>
          <ul class="list-menu ps-category-list">
            <li><a href="{% url 'store' %}">All Products</a></li>
            {% for category in links %}
              <li><a href="{{ category.get_url }}">{{ category.category_name }}</a></li>
            {% endfor %}
          </ul>

          <!-- PRICE RANGE -->
          <div class="ps-item-count-box ps-sidebar-header">Price Range</div>
          <form method="get">
            <div class="form-row mb-2">
              <div class="form-group col-6">
                <input type="number" name="min_price" placeholder="Min" class="form-control ps-price-input">
              </div>
              <div class="form-group col-6">
                <input type="number" name="max_price" placeholder="Max" class="form-control ps-price-input">
              </div>
            </div>
            <button type="submit" class="ps-btn ps-btn--primary btn-block">Apply</button>
          </form>

        </div>
      </aside>

      <!-- MAIN PRODUCTS -->
      <main class="col-md-9">
        <div class="ps-grid">
          {% if products %}
            {% for product in products %}
            <article class="ps-card">
              <a href="{{ product.get_url }}" class="ps-card__media">
                <img src="{{ product.images.url|default:'' }}" alt="{{ product.product_name|default:'Pokémon Item' }}">
                <div class="ps-card__overlay">View Details</div>
              </a>
              <div class="ps-card__body">
                <h3 class="ps-card__title">{{ product.product_name|default:'Unnamed Product' }}</h3>
                <div class="ps-card__meta">
                  <span class="ps-card__price">₹ {{ product.price|default:'0.00' }}</span>
                  <a href="{{ product.get_url }}" class="ps-btn ps-btn--buy">Buy Now</a>
                </div>
              </div>
            </article>
            {% endfor %}
          {% else %}
            <p class="ps-empty">No products available yet. Stay tuned!</p>
          {% endif %}
        </div>

        <!-- PAGINATION -->
        <nav class="mt-4" aria-label="Page navigation">
          {% if products.has_other_pages %}
          <ul class="pagination justify-content-center">
            {% if products.has_previous %}
              <li class="page-item"><a class="page-link" href="?page={{products.previous_page_number}}">Previous</a></li>
            {% else %}
              <li class="page-item disabled"><a class="page-link" href="#">Previous</a></li>
            {% endif %}
            {% for i in products.paginator.page_range %}
              {% if products.number == i %}
                <li class="page-item active"><a class="page-link" href="#">{{i}}</a></li>
              {% else %}
                <li class="page-item"><a class="page-link" href="?page={{i}}">{{i}}</a></li>
              {% endif %}
            {% endfor %}
            {% if products.has_next %}
              <li class="page-item"><a class="page-link" href="?page={{products.next_page_number}}">Next</a></li>
            {% else %}
              <li class="page-item disabled"><a class="page-link" href="#">Next</a></li>
            {% endif %}
          </ul>
          {% endif %}
        </nav>
      </main>

    </div>
  </div>
</section>

<style>
:root {
  --poke-yellow:#ffcb05;
  --poke-red:#e3350d;
  --poke-blue:#3b4cca;
  --white:#fff;
  --dark:#1b1b1b;
  --radius:18px;
  --shadow:0 8px 30px rgba(0,0,0,.15);
  --transition: all 0.3s ease;
  --font:'Poppins', sans-serif;
}
body { font-family: var(--font); background:#3b4cca; }

/* BUTTONS */
.ps-btn { padding:10px 18px; border-radius:999px; font-weight:700; border:2px solid var(--dark); transition:var(--transition); text-align:center;}
.ps-btn--primary { background:var(--poke-red); color:var(--white); box-shadow:2px 2px var(--poke-blue);}
.ps-btn--primary:hover { background:var(--poke-yellow); color:var(--dark); transform:translateY(-2px) scale(1.02);}
.ps-btn--buy { background:linear-gradient(to bottom,var(--poke-red) 50%,var(--white) 50%); color:var(--dark); padding:8px 12px; border-radius:999px; border:2px solid var(--poke-blue); box-shadow:2px 2px var(--poke-blue); font-size:0.85rem;}
.ps-btn--buy:hover { background:linear-gradient(to bottom,var(--poke-yellow) 50%,var(--white) 50%); transform:translateY(-2px) scale(1.05); box-shadow:4px 4px var(--poke-blue);}

/* GRID & CARD */
.ps-grid { display:grid; gap:26px; grid-template-columns: repeat(auto-fill,minmax(260px,1fr)); max-width:1200px; margin:0 auto;}
.ps-card { background:var(--white); border-radius:var(--radius); overflow:hidden; border:2px solid var(--poke-yellow); transition:var(--transition);}
.ps-card:hover { transform:translateY(-6px); box-shadow:var(--shadow);}
.ps-card__media { position:relative; overflow:hidden;}
.ps-card__media img { width:100%; height:260px; object-fit:cover; transition:var(--transition);}
.ps-card__overlay { position:absolute; bottom:0; left:0; right:0; background:rgba(0,0,0,0.6); color:var(--white); text-align:center; padding:8px; transform:translateY(100%); transition:var(--transition);}
.ps-card:hover .ps-card__overlay { transform:translateY(0);}
.ps-card:hover img { transform:scale(1.05);}
.ps-card__body { padding:14px;}
.ps-card__title { font-weight:700; margin-bottom:8px; font-size:1.1rem; text-align:center;}
.ps-card__meta { display:flex; justify-content:space-between; align-items:center; gap:8px;}
.ps-card__price { font-weight:800; color:var(--poke-red); background:var(--poke-yellow); padding:4px 10px; border-radius:6px; text-align:center;}

/* SIDEBAR */
.ps-sidebar { border-radius:18px; border:2px solid var(--poke-yellow); padding:16px; background:#fff; box-shadow:2px 2px 15px rgba(0,0,0,.1);}
.ps-sidebar-header { font-weight:700; color: var(--white); font-size:1.05rem; margin-bottom:12px; background: linear-gradient(135deg,#e3350d,#cc0000); padding:12px 18px; border-radius:18px; box-shadow: 1px 2px 12px rgba(0,0,0,0.15); transition: all 0.3s;}
.ps-sidebar-header:hover { transform: scale(1.02); box-shadow: 2px 4px 20px rgba(0,0,0,0.2); }
.ps-category-list { list-style:none; padding-left:0; margin-bottom:20px;}
.ps-category-list li { margin-bottom:6px;}
.ps-category-list li a { display:block; padding:8px 12px; border-radius:12px; color:var(--dark); font-weight:600; transition:all 0.3s;}
.ps-category-list li a:hover { background: var(--poke-yellow); color: var(--dark); transform: translateX(6px) scale(1.02); font-weight:700; box-shadow:2px 2px 10px rgba(227,53,13,0.3); }

/* Price Inputs */
.ps-price-input { border-radius:12px; border:2px solid var(--poke-yellow); padding:6px; transition: all 0.3s;}
.ps-price-input:focus { outline:none; border-color:var(--poke-red); box-shadow:0 0 12px rgba(227,53,13,0.5); transform: scale(1.02); }

/* ITEMS FOUND */
.ps-items-found { font-weight:700; color:var(--white); background: linear-gradient(135deg,#e3350d,#cc0000); padding:12px 18px; text-align:center; border-radius:18px; box-shadow:2px 2px 15px rgba(0,0,0,.2); font-size:1.2rem; margin-bottom:12px; text-transform:uppercase; letter-spacing:1px; transition: all 0.4s ease;}
.ps-items-found:hover { background: linear-gradient(135deg,#ff5555,#e3350d); transform: translateY(-2px) scale(1.03); box-shadow: 4px 4px 20px rgba(0,0,0,0.3); }

/* PAGINATION */
.pagination .page-item .page-link { color: var(--dark); border-radius: 12px; transition: var(--transition);}
.pagination .page-item.active .page-link { background: var(--poke-red); color: var(--white); transform: scale(1.05);}
.pagination .page-item .page-link:hover { background: var(--poke-yellow); color: var(--dark); transform: scale(1.03);}
</style>

{% endblock %}
